# å¤©æ°”æ—¶é’Ÿç»„ä»¶ä¿®å¤è®°å½•

**æ—¥æœŸ**: 2025-01-05
**ç‰ˆæœ¬**: v1.0.0
**ä¿®å¤äººå‘˜**: Claude + å“ˆåŸºç±³

## é—®é¢˜æè¿°

### 1. HTML è½¬ä¹‰é—®é¢˜
**ç°è±¡**: å‹é“¾é¡µé¢çš„æ—¶é’Ÿå’Œå¤©æ°”ä¿¡æ¯æ˜¾ç¤ºä¸º HTML æºç è€Œéå®é™…æ¸²æŸ“æ•ˆæœ
```
æ˜¾ç¤º: &lt;span id=&quot;current-time&quot;&gt;åŠ è½½ä¸­...&lt;/span&gt;
æœŸæœ›: <span id="current-time">åŠ è½½ä¸­...</span>
```

**æ ¹æœ¬åŸå› **: Markdown æ–‡ä»¶ä¸­çš„ HTML ä»£ç è¢« Hugo çš„ Goldmark è§£æå™¨å½“ä½œä»£ç å—å¤„ç†ï¼ˆå› ä¸ºæœ‰ç¼©è¿›ï¼‰ï¼Œå¯¼è‡´ HTML è¢«è½¬ä¹‰

### 2. åŠŸèƒ½ç¼ºå¤±
- å®æ—¶æ—¶é’Ÿä¸æ›´æ–°ï¼Œæ˜¾ç¤º"åŠ è½½ä¸­..."å ä½ç¬¦
- å¤©æ°”ä¿¡æ¯æ— æ³•è·å–
- IP å®šä½å¤±è´¥

## è§£å†³æ–¹æ¡ˆ

### æŠ€æœ¯æ–¹æ¡ˆ
ä½¿ç”¨ Hugo çŸ­ä»£ç ï¼ˆshortcodeï¼‰ç»•è¿‡ Markdown è§£æï¼Œç¡®ä¿ HTML å’Œ JavaScript æ­£ç¡®æ‰§è¡Œ

### å®æ–½æ­¥éª¤

#### 1. åˆ›å»ºé€šç”¨çŸ­ä»£ç 
**æ–‡ä»¶**: `layouts/shortcodes/site_info_bar.html`

**åŠŸèƒ½**:
- å®æ—¶æ—¶é’Ÿï¼šæ ¼å¼ `2026-01-05 æ˜ŸæœŸä¸€ 22:44:21`ï¼Œæ¯ç§’æ›´æ–°
- IP æ£€æµ‹ï¼šè‡ªåŠ¨è·å–è®¿å®¢ IP åœ°å€
- åœ°ç†ä½ç½®å®šä½ï¼šæ ¹æ® IP æ˜¾ç¤º åŸå¸‚ Â· åœ°åŒº Â· å›½å®¶
- å®æ—¶å¤©æ°”ï¼šæ¸©åº¦ï¼ˆÂ°Cï¼‰+ å¤©æ°”æè¿° + é£é€Ÿ
- åŠ¨æ€å›¾æ ‡ï¼šæ ¹æ®å¤©æ°”ä»£ç æ˜¾ç¤ºå¯¹åº” Emoji

#### 2. API é›†æˆ

**IP å®šä½æœåŠ¡**ï¼ˆè‡ªåŠ¨å¤±è´¥å›é€€ï¼‰:
1. `https://ipapi.co/json/`
2. `https://ipwho.is/json/`

**å¤©æ°”æœåŠ¡**:
- Open-Meteo API (æ— éœ€å¯†é’¥)
- URL: `https://api.open-meteo.com/v1/forecast`

**å¤‡ç”¨æ–¹æ¡ˆ**:
- æµè§ˆå™¨åœ°ç†å®šä½ API (`navigator.geolocation`)

#### 3. ä»£ç ç»“æ„

```javascript
// æ ¸å¿ƒåŠŸèƒ½æ¨¡å—
- updateClock()         // æ—¶é’Ÿæ›´æ–°
- getIpData()          // IP è·å–
- getCoordsViaGeolocation()  // æµè§ˆå™¨å®šä½
- weatherCodeToText()  // å¤©æ°”ä»£ç è½¬ä¸­æ–‡
- weatherCodeToEmoji() // å¤©æ°”ä»£ç è½¬å›¾æ ‡
- init()               // åˆå§‹åŒ–ä¸»å‡½æ•°
```

#### 4. é¡µé¢é›†æˆ

**æ›´æ–°çš„æ–‡ä»¶**:
- `content/about.md` - æ·»åŠ  `{{< site_info_bar >}}`
- `content/posts/first-article.md` - æ·»åŠ  `{{< site_info_bar >}}`
- `content/posts/hugo-tutorial.md` - æ·»åŠ  `{{< site_info_bar >}}`
- `content/friends.md` - ä½¿ç”¨ä¸“ç”¨ `{{< friends_header >}}`

**çŸ­ä»£ç å·®å¼‚**:
- `site_info_bar`: é€šç”¨ä¿¡æ¯æ ï¼Œç”¨äºæ‰€æœ‰é¡µé¢
- `friends_header`: ä¸“é—¨ä¸ºå‹é“¾é¡µé¢å®šåˆ¶ï¼ˆåŒ…å«é¢å¤–æ ·å¼ï¼‰

### æ ·å¼ä¼˜åŒ–

**å“åº”å¼è®¾è®¡**:
```css
@media (max-width: 768px) {
    .info-bar {
        flex-direction: column;
        align-items: flex-start;
    }
}
```

**è§†è§‰ç‰¹æ€§**:
- å¡ç‰‡å¼è®¾è®¡ï¼Œåœ†è§’è¾¹æ¡†
- æŸ”å’Œé˜´å½±æ•ˆæœ
- è‡ªé€‚åº”ä¸»é¢˜é¢œè‰²ï¼ˆæ·±è‰²/æµ…è‰²æ¨¡å¼ï¼‰
- IP åœ°å€å·¦ä¾§åˆ†éš”çº¿

## æŠ€æœ¯ç»†èŠ‚

### WMO å¤©æ°”ä»£ç æ˜ å°„

| ä»£ç  | æè¿° | å›¾æ ‡ |
|------|------|------|
| 0 | æ™´æœ— | â˜€ï¸ |
| 1-3 | å¤šäº‘ | â›… |
| 45, 48 | é›¾ | ğŸŒ«ï¸ |
| 51-67 | å°é›¨ | ğŸŒ§ï¸ |
| 71-77 | å°é›ª | â„ï¸ |
| 80-82 | é˜µé›¨ | ğŸŒ¦ï¸ |
| 95+ | é›·æš´ | âš¡ |

### API è¶…æ—¶é…ç½®

```javascript
const fetchJSON = (url, ms = 6000) => Promise.race([
    fetch(url).then(r => r.ok ? r.json() : Promise.reject(r)),
    timeout(ms)
]);
```

- IP æœåŠ¡: 6 ç§’è¶…æ—¶
- å¤©æ°”æœåŠ¡: 7 ç§’è¶…æ—¶
- æµè§ˆå™¨å®šä½: 8 ç§’è¶…æ—¶

## éƒ¨ç½²è®°å½•

### Git æäº¤
```
commit a00deac
Fix weather widget and clock display using Hugo shortcode
```

### æ–‡ä»¶å˜æ›´
```
M  content/about.md
M  content/posts/first-article.md
M  content/posts/hugo-tutorial.md
M  layouts/shortcodes/friends_header.html
A  layouts/shortcodes/site_info_bar.html
```

## éªŒè¯æµ‹è¯•

### åŠŸèƒ½æµ‹è¯•æ¸…å•
- [x] æ—¶é’Ÿæ¯ç§’æ›´æ–°
- [x] IP åœ°å€æ­£ç¡®è·å–
- [x] åœ°ç†ä½ç½®å‡†ç¡®æ˜¾ç¤º
- [x] å¤©æ°”æ•°æ®å®æ—¶è·å–
- [x] å›¾æ ‡ä¸å¤©æ°”åŒ¹é…
- [x] ç§»åŠ¨ç«¯å“åº”å¼æ­£å¸¸
- [x] æ·±è‰²æ¨¡å¼å…¼å®¹
- [x] API å¤±è´¥è‡ªåŠ¨å›é€€

### æµè§ˆå™¨å…¼å®¹æ€§
- Chrome/Edge 60+
- Firefox 55+
- Safari 11+
- ç§»åŠ¨æµè§ˆå™¨

## æ€§èƒ½ä¼˜åŒ–

1. **æ‡’åŠ è½½**: JavaScript åœ¨ DOMContentLoaded åæ‰§è¡Œ
2. **ç¼“å­˜ç­–ç•¥**: æµè§ˆå™¨å®šä½ç¼“å­˜ 10 åˆ†é’Ÿ
3. **å¼‚æ­¥è¯·æ±‚**: æ‰€æœ‰ API è°ƒç”¨ä½¿ç”¨ async/await
4. **é”™è¯¯å¤„ç†**: å®Œå–„çš„ try-catch å’Œå›é€€æœºåˆ¶

## å·²çŸ¥é—®é¢˜

1. æŸäº›ç½‘ç»œç¯å¢ƒä¸‹ IP API å¯èƒ½é™æµ
2. å¤©æ°” API ä¾èµ–å¤–éƒ¨æœåŠ¡ï¼Œæ— æ³• 100% ä¿è¯å¯ç”¨æ€§
3. æµè§ˆå™¨å®šä½éœ€è¦ç”¨æˆ·æˆæƒ

## åç»­æ”¹è¿›è®¡åˆ’

- [ ] æ·»åŠ å¤©æ°”æ•°æ®ç¼“å­˜ï¼ˆlocalStorageï¼‰
- [ ] æ”¯æŒæ‰‹åŠ¨åˆ·æ–°ä½ç½®
- [ ] æ·»åŠ æ›´å¤šå¤©æ°” API å¤‡ç”¨æœåŠ¡
- [ ] å®ç°ç¦»çº¿æ¨¡å¼æç¤º
- [ ] æ·»åŠ åŠ è½½åŠ¨ç”»æ•ˆæœ

## ç›¸å…³èµ„æº

- [Hugo çŸ­ä»£ç æ–‡æ¡£](https://gohugo.io/templates/shortcode-templates/)
- [Open-Meteo API](https://open-meteo.com/)
- [IPAPI.co](https://ipapi.co/)
- [IPWHO.is](https://ipwho.is/)

## é™„å½•ï¼šå®Œæ•´ä»£ç ç¤ºä¾‹

å‚è§æ–‡ä»¶ï¼š
- `/layouts/shortcodes/site_info_bar.html`
- `/layouts/shortcodes/friends_header.html`

---

**ä¿®å¤çŠ¶æ€**: âœ… å·²å®Œæˆ
**æœ€åæ›´æ–°**: 2025-01-05 22:45:00
